% **************************************************
% Document Class Definition
% **************************************************
\documentclass[%
	paper=A4,					% paper size --> A4 is default in Germany
	twoside=true,				% onesite or twoside printing
	openright,					% doublepage cleaning ends up right side
	parskip=half,				% spacing value / method for paragraphs
	chapterprefix=true,			% prefix for chapter marks
	10pt,						% font size
	headings=normal,			% size of headings
	bibliography=totoc,			% include bib in toc
	listof=totoc,				% include listof entries in toc
	titlepage=on,				% own page for each title page
	captions=tableabove,		% display table captions above the float env
  draft=false,				% value for draft version
  numbers=noenddot
]{scrreprt}%

% **************************************************
% Debug LaTeX Information
% **************************************************
%\listfiles

% **************************************************
% Information and Commands for Reuse
% **************************************************
\newcommand{\thesisTitle}{Protecting valuable resources using optimal control theory and feedback strategies for plant disease management}
\newcommand{\thesisName}{Elliott Hamilton Bussell}
\newcommand{\thesisSubject}{Epidemiology}
\newcommand{\thesisCollege}{Jesus College}
\newcommand{\thesisDate}{September 2019}
% \newcommand{\thesisVersion}{My First Draft}

\newcommand{\thesisFirstSupervisor}{Nik Cunniffe}
\newcommand{\thesisSecondSupervisor}{Chris Gilligan}

\newcommand{\thesisUniversity}{\protect{University of Cambridge}}
\newcommand{\thesisUniversityDepartment}{Department of Plant Sciences}

% **************************************************
% Load and Configure Packages
% **************************************************
\usepackage{amsmath}
\usepackage[utf8]{inputenc}		% defines file's character encoding
\usepackage[english]{babel} % babel system, adjust the language of the content
\usepackage[nodisplayskipstretch]{setspace}
\usepackage[					% clean thesis style
	figuresep=colon,%
	sansserif=false,%
	hangfigurecaption=false,%
	hangsection=true,%
	hangsubsection=true,%
	colorize=full,%
	colortheme=bluemagenta,%
	bibsys=bibtex,%
	bibfile=References.bib,%
	bibstyle=authoryear,%
]{my_cleanthesis}

\bibliography{References.bib}
% \cthesissetcolor{cmyk}{1, .50, .10, .01}{.18, .0, .18, 0}%

\usepackage{afterpage}
\usepackage{lineno}
\usepackage[group-digits=integer,group-separator={,},group-minimum-digits={4},per-mode=reciprocal,binary-units=true]{siunitx}
\usepackage{duckuments}
\usepackage{booktabs}
\usepackage{placeins}
\usepackage{algorithm}
\usepackage{algorithmicx}
\usepackage{float}
\usepackage{subcaption}
\usepackage[all]{hypcap}
\usepackage{multirow}
\usepackage{array}
\usepackage{bm}
\usepackage{tocbibind}
\usepackage{layouts}
\usepackage{appendix}
\usepackage[percent]{overpic}

% \renewcommand{\appendixname}{Annex}

\captionsetup[algorithm]{font=small, labelfont={bf,sf,color=ctcolorfloatlabel}, format=hang, labelsep=colon, singlelinecheck=false}

\DeclareSIUnit\t{t}
\DeclareSIUnit\year{year}
\DeclareSIUnit\week{wk}
\DeclareSIUnit\years{years}
\DeclareSIUnit\hosts{hosts}
\DeclareSIUnit\host{host}
\DeclareSIUnit{\feet}{ft}
\sisetup{detect-all=true, per-mode=reciprocal}

% Bibliography setup
\DeclareFieldFormat[article]{titlecase}{\MakeSentenceCase*{#1}}
\DeclareFieldFormat[book]{titlecase}{#1}
\newbibmacro*{journal}{%
  \iffieldundef{journaltitle}
    {}
    {\printtext[journaltitle]{%
       \printfield[noformat]{journaltitle}%
       \setunit{\subtitlepunct}%
	   \printfield[noformat]{journalsubtitle}}}}
\AtEveryBibitem{%
	   \clearfield{number}}
\DeclareFieldFormat[article]{volume}{\mkbibbold{#1}}
\DeclareFieldFormat[article,inbook,incollection,inproceedings,patent,thesis,unpublished]{title}{#1\isdot}
\renewbibmacro{in:}{}
\renewcommand{\bibfont}{\normalfont\small}
\setlength{\biblabelsep}{0pt}
\setlength{\bibitemsep}{0.5\baselineskip plus 0.5\baselineskip}
\renewbibmacro{in:}{%
  \ifentrytype{article}{}{\printtext{\bibstring{in}\intitlepunct}}}
\DeclareFieldFormat[online]{url}{Available at: \url{#1}}
\DeclareFieldFormat[online]{urldate}{\mkbibparens{\bibstring{urlseen}\space#1}}

\renewcommand{\arraystretch}{1.5}

\newcommand\todo[1]{\textcolor{red}{#1}}
\newcommand\citationneeded{\textcolor{blue}{[citation needed]}}
\newcommand{\etal}{\textit{et al}.}
\newcommand\vect[1]{\mathbf{\bm{#1}}}
\def\CC{{C\nolinebreak[4]\hspace{-.05em}\raisebox{.4ex}{\tiny\textbf ++}}}

\usepackage{hyperref}
\hypersetup{					% setup the hyperref-package options
pdftitle={\thesisTitle},	% 	- title (PDF meta)
pdfsubject={\thesisSubject},% 	- subject (PDF meta)
pdfauthor={\thesisName},	% 	- author (PDF meta)
plainpages=false,			% 	-
colorlinks=false,			% 	- colorize links?
pdfborder={0 0 0},			% 	-
breaklinks=true,			% 	- allow line break inside links
bookmarksnumbered=true,		%
bookmarksopen=true,			%
bookmarksopenlevel=0,
pdfpagelayout=TwoPageRight
}
\usepackage{bookmark}

\usepackage[many]{tcolorbox}
\usetikzlibrary{calc}

\tcbset{mystyle/.style={
  breakable,
  enhanced,
  parbox=false,
  outer arc=0pt,
  arc=0pt,
  colframe=white,
  boxrule=0pt,
  colback=ctcoloraccessory!7.5,
  coltitle=black,
  colbacktitle=white,
  bottomtitle=0mm,
  lefttitle=0mm,
  boxsep=0mm,
  top=3mm,
%   attach boxed title to top left,
%   boxed title style={
% 	coltitle=ctcoloraccessory,
% 	colback=white,
%     outer arc=0pt,
%     arc=0pt,
%     top=0pt,
%     bottom=0pt,
%     },
  fonttitle=\tgherosfont
  }
}

\newtcolorbox[auto counter]{example}[1][]{
  mystyle,
%   colback=white,
%   rightrule=0pt,
%   toprule=0pt,
  title=\captionof{Example}{#1},
}
\newfloat{Example}{htbp}{loa}
\raggedbottom


\DeclareFieldFormat{citehyperref}{%
  \DeclareFieldAlias{bibhyperref}{noformat}% Avoid nested links
  \bibhyperref{#1}}

\DeclareFieldFormat{textcitehyperref}{%
  \DeclareFieldAlias{bibhyperref}{noformat}% Avoid nested links
  \bibhyperref{%
    #1%
    \ifbool{cbx:parens}
      {\bibcloseparen\global\boolfalse{cbx:parens}}
      {}}}

\savebibmacro{cite}
\savebibmacro{textcite}

\renewbibmacro*{cite}{%
  \printtext[citehyperref]{%
    \restorebibmacro{cite}%
    \usebibmacro{cite}}}

\renewbibmacro*{textcite}{%
  \ifboolexpr{
    ( not test {\iffieldundef{prenote}} and
      test {\ifnumequal{\value{citecount}}{1}} )
    or
    ( not test {\iffieldundef{postnote}} and
      test {\ifnumequal{\value{citecount}}{\value{citetotal}}} )
  }
    {\DeclareFieldAlias{textcitehyperref}{noformat}}
    {}%
  \printtext[textcitehyperref]{%
    \restorebibmacro{textcite}%
    \usebibmacro{textcite}}}

% **************************************************
% Document CONTENT
% **************************************************
% \includeonly{Chapters/Chapter08}
% To print only figures:
% \usepackage[active, tightpage]{preview}
% \PreviewBorder=12pt\relax
% \PreviewSnarfEnvironment[{[]}]{figure}
\begin{document}
% Text width is 5.47293 inches
% Paper width is 8.26933 inches
% --------------------------
% rename document parts
% --------------------------
\renewcaptionname{english}{\figurename}{Figure}
\renewcaptionname{english}{\tablename}{Table}

% --------------------------
% Front matter
% --------------------------
%TC:ignore
\pagenumbering{arabic}			% arabic page numbering
\include{Chapters/Titlepages}		% INCLUDE: all titlepages
%TC:endignore
\include{Chapters/Abstract}
%TC:ignore
\include{Chapters/Frontmatter}

% --------------------------
% Body matter
% --------------------------
%TC:endignore
\pagestyle{maincontentstyle} 	% fancy header and footer

\setlength{\parindent}{15pt}
\setstretch{1.5}
% \setlength{\skip\footins}{2cm}
\setlength{\skip\footins}{2pc plus 5pt}

\include{Chapters/Chapter01}
\include{Chapters/Chapter02}
\include{Chapters/Chapter03}
\include{Chapters/Chapter04}
\include{Chapters/Chapter05}
\include{Chapters/Chapter06}
\include{Chapters/Chapter07}
\include{Chapters/Chapter08}

% --------------------------
% Back matter
% --------------------------
%TC:ignore
\include{Chapters/Backmatter}

\begin{appendices}
\include{Chapters/AppendixA}
\include{Chapters/AppendixB}
\include{Chapters/AppendixC}
\end{appendices}
  %TC:endignore
% **************************************************
% End of Document CONTENT
% **************************************************
\end{document}
