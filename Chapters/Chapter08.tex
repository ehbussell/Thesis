% !TEX root = ../thesis.tex
%
\chapter{Discussion\label{ch:discussion}}

\section{Thesis Summary}

The threat from plant disease epidemics to the natural environment is severe \citep{freer_tree_2017}, but mathematical models can be used to help design and optimise management strategies to better control spread \citep{lofgren_opinion_2014,cunniffe_optimising_2015}. The complexity of the simulation models used to inform policy however \citep[e.g.][]{defra_chalara_2013}, limits the extent to which dynamic controls can be optimised. For such models, multiple controls that vary in space and time can only be optimised through strategy testing: where a limited number of simple, plausible interventions are tested using a simulation model. In this thesis, our aim was to develop frameworks to aid optimisation of these simulation models, applied to the case study of determining effective and practical local management of SOD.

In Chapter~\ref{ch:three_patch} we showed how OCT can be applied to a simple model of a disease invading a highly valuable region. We found that in general it is best to prioritise control in the valuable region, but that switching strategies can perform better under certain parameter values. We tested direct and indirect numerical methods for solving the optimal control problem, showing that the direct method is accurate and more reliable than the indirect approach. The optimal strategy was not necessarily robust though, with significant errors when spread parameters were not known precisely. This motivates---at least in part---the problem solved in Chapter~\ref{ch:complex_models}, where we developed a framework for applying optimal control results to complex simulation models. By using a feedback framework, model predictive control (MPC), we showed how the predictive power of simulation models can be coupled with insights from OCT obtained from approximate models to find effective disease management strategies.

In Chapters~\ref{ch:protect_tanoak_model} and \ref{ch:protect_tanoak_control} we applied this framework to the practical question of how to control SOD in a newly invaded forest stand in order to protect valuable tanoak. This objective for local control is important, since widespread eradication of SOD is now impossible \citep{cunniffe_modelling_2016}, and so smaller-scale local goals that remain achievable and protect valuable resources are of interest. We showed how MPC finds strategies that align with management advice from the US Forest Service, but with additional important time dependence. The MPC framework finds strategies that are robust to parameter and observational uncertainty, showing the greatest improvement in control in the worst-case scenarios. Finally, in Chapter~\ref{ch:redwood} we applied OCT to spatial optimisation of control strategies to protect Redwood National Park from SOD invasion. We showed how the strategies that perform best make use of epidemiological features, such as prioritising control where weather conditions are most conducive to pathogen spread. The OCT informed management performs better than the \SI{100}{\meter} buffer strategy that was actually applied. Again, we showed that the OCT strategies limit the impacts of disease in the worst-case scenarios.

\section{Contributions and limitations}

\subsection{Optimal control theory}\label{sec:ch8:contributions_oct}

The overarching theme of this thesis is how to apply OCT to the problem of disease management, determining which control methods are most appropriate and how, when and where they should be deployed. The time-dependent strategies identified using OCT allow deployment of different control resources as an epidemic progresses. This switching, either between control methods or changing where control is applied, ensures that the optimal strategy is used at all times, allowing management to respond to changing risk \citep{hyatt-twynam_risk-based_2017} and to always match the scale of the epidemic \citep{gilligan_impact_2007}. We have shown how this improves management, echoing the results of other OCT and plant disease modelling studies \citep[e.g.][]{forster_optimizing_2007, ndeffo_mbah_resource_2011}, as well as for other disease systems \citep{keeling_optimal_2012,klepac_optimizing_2012}, and control of invasive species \citep{carrasco_optimal_2009}.

Many different methods can be used to solve these optimal control problems, and we have tested both direct and indirect approaches. We tested the indirect forward-backward sweep method and the direct transcription method, chosen as they are both widely used to solve OCT problems. We did not test other approaches, such as multiple shooting methods, since the direct transcription method was sufficiently accurate, robust and reliable for the models considered here. Whilst the indirect methods do allow for more mathematical insight through analytic descriptions of the optimal control, applying the direct methods here allowed us to reliably and robustly solve larger problems where convergence of indirect methods would be limiting. The optimisation approaches we used allowed us to optimise deployment of many different control methods, with OCT identifying which of 9 different controls is optimal for control in a mixed stand.

Ultimately this led to optimising control of a fully spatial system around Redwood National Park, allowing the question of where control resources should be deployed to be answered with sufficiently resolved spatial strategies. Other studies have also optimised similar spatial management strategies, for example work by \citet{epanchin_optimal_2012}. The model used by \citet{epanchin_optimal_2012} though, required significant simplification to allow optimisation, with a discrete nearest-neighbour spread model in which cells are either invaded or not. Our work on the other hand, only reduced the resolution of the model to be optimised. Different approaches apply OCT to PDE models of disease spread, for example work by \citet{neilan_optimal_2011}, \citet{christley_optimal_2016}, and \citet{miyaoka_optimal_2019}. The reaction-diffusion type models used by these studies solve a similar problem to the problem of Chapter~\ref{ch:redwood}, and the work by \citet{miyaoka_optimal_2019} finds strategies that are significantly more spatially resolved than ours. These approaches could be used to extend our models, but importantly, none of these studies test results on more realistic models. Also, there is more scope with metapopulation type models to incorporate long distance dispersal, so that disease can still invade a fragmented landscape. Whether an ODE or PDE model is used for optimisation however, the simplifications made in these approximate models---to spatial structure for example---necessitate robustness testing of the optimal strategies.

This testing of OCT strategies can result in poor performance when there is uncertainty about parameters or the system is highly complex, as we showed in Chapters~\ref{ch:three_patch} and \ref{ch:complex_models}. Work by \citet{forster_optimizing_2007} showed that knowing the precise optimal time for a switch in an OCT strategy is important, and that inaccuracies can lead to management that is worse than using a much simpler strategy. Similarly, \citet{carrasco_optimal_2009} showed for control of invasive species that the optimal strategy is not always robust once parameter uncertainty is introduced. This and our comparisons of the open-loop and MPC strategies highlight the importance of simulation models for making accurate disease forecasts. For informing practical control, realistic complex models are needed to test and assess potential interventions. When data is limited though, these simulation models may not be as accurate as is required for policy. An advantage of a simulation model however, is that uncertainties can be included, for example through sampling from a parameter distribution \citep[e.g.][]{cook_constructing_2008,parry_bayesian_2014,cunniffe_optimising_2015}.

\subsection{Optimising complex systems}

Our approach to optimising complex simulation models was to start with a simpler approximate model for which the optimal control problem is more tractable: an approach commonly used in applications of OCT to engineering such as chemical plant control \citep{lee_model_2011}. The biggest factor affecting the size, and hence difficulty, of the optimal control problem is the spatial resolution of the model. To reduce the size of the state-space, we factored out space either completely in Chapter~\ref{ch:protect_tanoak_control}, into metapopulations in Chapters~\ref{ch:three_patch} and \ref{ch:complex_models}, or used reduced resolution models in Chapter~\ref{ch:redwood}. These approaches retain spatial detail when required for the problem at hand, allowing OCT to give the most spatially resolved strategies possible. However, as with most OCT models, these approximations do lead to differences between the approximate model and the complex simulation model used for testing, and our solutions have limited spatial detail.

The MPC framework for disease control we have developed accounts for these inaccuracies in the approximate model. Other studies have considered MPC for disease control \citep{selley_dynamic_2015}, as well as for other applications such as chemical plants and the fields of manufacturing and aerospace \citep{qin_survey_2003}. However, ours is the first study to apply the full system, with approximate and simulation models, to practical disease management questions. The feedback strategies allow the insights of OCT to be applied, whilst also adapting control to each epidemic realisation, and lead to improved control over an open-loop application of OCT results. We have demonstrated that MPC is a suitable framework for asking how to deploy control, showing in multiple scenarios that MPC provides the best strategies.

The main benefit of MPC is in the robustness of the framework to stochasticity, parameter uncertainty and imperfect surveillance. We have shown that adapting control through MPC handles these complexities, and minimises the risk of large-scale failures. We explained in Chapter~\ref{ch:intro} how poorly designed management strategies have led to the failure of control for dutch elm disease, citrus canker, and ash dieback. The strategies we have identified could limit failures such as these through adapting control. We have shown that MPC is of the most benefit during the most damaging epidemics. In Chapter~\ref{ch:protect_tanoak_control} we saw that under parameter uncertainty MPC provides the greatest benefit in the worst-case scenarios. Similarly, the OCT strategies in Chapter~\ref{ch:redwood} improve control in the worst-case epidemics. Finding robust control strategies is vital for effective decision making.

\subsection{Objectives for disease management}

Assessing strategies for potential policy decisions requires a clear quantification of the management goals; decision makers must ask why control is needed. For SOD, and arguably for management of plant diseases in the natural environment more generally, the consideration of solely large scale objectives has limited the utility of mathematical models. Here we have made progress by using management goals that focus on local disease control, prioritising protection of high value resources whether they be particular species or particular regions. These local goals have been shown to be achievable in the field \citep{hansen_efficacy_2019}, and are still beneficial because of the high value of forest resources \citep{green_future}. Our frameworks apply the predictive power of simulation models and the insights of OCT to these management goals, and we have demonstrated the effectiveness of the resulting strategies.

The objective we used in Chapter~\ref{ch:protect_tanoak_control} combined the goals of protecting tanoak and conserving biodiversity. This highlighted the importance of considering wider management goals when optimising disease control, since the choice of objective impacts on optimal strategies \citep{probert_decision_2016}. However, our inclusion of biodiversity was still fairly simplistic, and other goals such as fire management and timber value were not accounted for. Nevertheless, we showed how goals such as these can alter the optimal control strategy, avoiding complete removal of bay and redwood. Similarly, in Chapter~\ref{ch:redwood} control was optimised to protect the national park. But the objective did not account for the proximity of tribal lands, or commercially valuable stands. Whilst there is more scope in plant disease, as opposed to human or animal health, to protect one area or host at the detriment of others, wider implications must still be considered. This only highlights further the importance of the simulation model for assessing the resulting strategies. Any OCT informed strategies can be compared with other plausible interventions using the strategy testing approach. This allows the utility of the OCT informed strategies to be demonstrated as we did throughout this thesis, but also allows other consequences to be considered even when not formally included in the objective function. The simulation model can be used as a proxy for the real world, to illustrate the wider impacts of disease and control.

\subsection{Practical management}

In this thesis we have answered the questions of which control methods to use, and where, when, how and why to deploy these for disease management. Combining these solutions allows practical management advice. Using the frameworks we have developed for practical advice requires a fine balance between the realism of the simulation model, the level of approximation for optimising control, the choice of objective function and the constraints on the system. If all of these are aligned correctly then the resulting control strategies could provide practical and realistic advice.

The strategies we have found for local SOD management are arguably highly complex; the strategies show much time-dependence with many control switches and require a hierarchy of models. In their current form these results are unlikely to inform disease management in the real world because of the practical barriers to implementing such complex strategies. The results could still be of use though, through development of rules of thumb \citep[e.g.][]{parnell_early_2015,hyatt-twynam_risk-based_2017}, or greater understanding of the drivers behind the optimal strategy. This could include optimal bay densities for thinning in mixed stands, or identification of areas that should be thinned and areas that should be rogued when protecting a valuable region. Information such as this could help inform practical management.

The variable level of surveillance in Chapter~\ref{ch:protect_tanoak_control} allows a decision maker to vary the complexity of the MPC framework to suit the local disease risk. Regular updates are more important when there is a high risk of disease re-emergence, and when optimal control strategies are highly sensitive to changes in the system. We showed that in the mixed stand case the form of the optimal control was not sensitive to parameter changes, but because of the fine balance between tanoak retention and biodiversity conservation, small changes in the strategy did affect performance.

Alongside the complexity of the optimal strategies, there is the question of when the more complex MPC strategy is required. We showed the benefit of MPC when the approximate model degrades in accuracy, but also showed in Chapter~\ref{ch:protect_tanoak_control} that when the approximate model closely matches the simulation throughout the epidemic (Section~\ref{sec:ch6:refined_strat}, p.~\pageref{sec:ch6:refined_strat}), there is little benefit to MPC over open-loop. The benefit of MPC is to account for inaccuracies when the approximate model is unable to capture the full simulation dynamics, but how complex should the approximate model be? Here we made the approximate model as complex as possible whilst ensuring the optimisation was still tractable, but more systematic methods could be developed. The biggest problem with MPC more broadly, is the need of an underlying model \citep{camacho_model_1995}. This model must be simple enough to optimise but complex enough to capture the main disease characteristics. If there is significant variation or stochasticity in the real world, then the surveillance and re-optimisation of MPC will be necessary regardless of the quality of the approximate model.

\section{Scope for future work}

There is scope in future work to extend the complexity of the underlying approximate models. In particular, our approximate models either factor out the heterogeneity of space entirely by assuming well-mixed dynamics (Chapters~\ref{ch:protect_tanoak_model} and \ref{ch:protect_tanoak_control}), or include only a restricted resolution via metapopulation approximations (Chapters~\ref{ch:complex_models} and \ref{ch:redwood}). However, in all cases well-mixing is assumed at some level. There is a wide body of work showing how spatial heterogeneities can be handled empirically by using non-linear incidence functions to better approximate spatial dynamics \citep[e.g.][]{liu_influence_1986, clarke_approximating_2013, chowell_mathematical_2016,chowell_using_2016}. However, since these forms are highly empirical, it is important to ensure they fit simulation dynamics well under different time-dependent control strategies. Doing so adaquately under the full range of possible controls with a single approximation might even prove impossible, as we found for the approximate model in Chapter~\ref{ch:protect_tanoak_control} where control rates had to be scaled to match the control scheme. We also found that such complexity in the underpinning model can hinder optimisation convergence, particularly when derivatives are calculated through automatic differentiation, as was the case when the package BOCOP was used in Chapters~\ref{ch:complex_models} and \ref{ch:protect_tanoak_control}.

Although here we used both network and structured metapopulation models for simulations, alternative approaches to modelling space could be used, both in the approximate model and the simulation model. For example, PDE type models as discussed in Section~\ref{sec:ch8:contributions_oct} \citep[e.g.][]{white_role_2006,neilan_optimal_2011,miyaoka_optimal_2019} could be used as approximate models, potentially allowing for higher resolution spatial strategies because there would be no requirement to quantise space. Alternatively, the spatial detail of the simulation model could be improved by using individual-based models \citep[e.g.][]{cook_constructing_2008,cunniffe_optimising_2015}, capturing the dynamics of each host individually, although this could be overly detailed. This would also allow the raster approximation we used in Chapter~\ref{ch:redwood} to be tested, determining the appropriate resolution of the simulation model.

We have only tested a limited set of optimisation approaches in this thesis. In particular, we have used deterministic OCT to find robust control strategies for simulation models that in some cases were stochastic. It would be interesting to extend these analyses to use stochastic OCT \citep{bertsekas_dynamic_2001}, and to compare the resulting optimal strategies with the deterministic analogues. Stochastic OCT can find more robust control strategies by incorporating noise into the differential equations, but this does significantly increase the complexity of the problem and only certain forms of noise can be included. In Chapter~\ref{ch:protect_tanoak_control} we touched on optimising multiple objectives, there combining tanoak retention and biodiversity conservation. This could be extended to explicitly analyse multi-objective controls, including wider disease impacts such as fire risk and CO\textsubscript{2} capture in the OCT objective. However, combining multiple objectives meaningfully can be difficult \citep{probert_decision_2016}.

It would also be interesting to investigate optimisation approaches other than OCT\@. Reinforcement learning (RL) is a field of machine learning concerned with computational agents learning actions to maximise rewards, and has many parallels with OCT \citep{recht_tour_2019}. Where OCT determines the optimal strategy based on a model of the dynamics, RL approaches learn the underlying model whilst optimising the objective function. Recent advances have shown that RL can solve very large problems, most notably defeating a human professional player at the game of Go, for which exhaustive searching of solutions is infeasible \citep{silver_mastering_2016}. Using these approaches could find novel strategies in complex simulation models, solving problems with significantly more spatial detail for example. The approach has recently been shown to be effective in a proof of concept application to control of foot and mouth disease in animals \citep{probert_context_2019}. The disadvantage of this approach is a lack of understanding of how the decisions are made. This could hamper translation into policy.

We emphasised throughout this thesis the importance of robust control strategies, i.e.\ strategies that under stochasticity and uncertainty still ensure effective disease management. There is scope to extend this further in our work to more formally optimise robust strategies. The strategies we have developed could be further tested under parameter uncertainties, potentially including estimation of parameters \citep{parry_bayesian_2014}, as well as more precise estimates as the epidemic progresses \citep{thompson_control_2018}. Another potential avenue would be to use Robust MPC \citep{bemporad_robust_1999}, an approach that explicitly accounts for uncertainty in the controller by testing worst-case scenarios. This could provide guarantees of management performance under defined levels of uncertainty, limiting the worst-case scenarios in a more formal framework than we have so far considered.

Finally, our work could be applied to other disease systems where control may be more effective than is now possible with SOD, for example management of the ongoing epidemic of olive quick decline syndrome in southern Europe caused by \emph{Xylella fastidiosa} \citep{sicard_xylella_2018}, or to diseases with major food security implications such as cassava brown streak disease in East Africa \citep{legg_comparing_2011} or maize lethal necrosis \citep{hilker_modeling_2017}. Additional real-world complexities could also be included into the models, for example the effects of human behaviour and non-compliance with disease management. Our spatial optimisations could be extended to a landscape of individual decision makers with contrasting management goals similar to the systems considered by \citet{epanchin_social_2010} and \citet{milne_effect_2015} for example. Management could then be optimised to provide incentives and dis-incentives to align individual goals with the aim of wider disease management.

\section{Concluding remarks}

The setting of this thesis has been to combine methods from the fields of mathematics, biology and systems engineering. We have made progress in the difficult problem of optimising controls in complex epidemiological simulation models that capture enough realism to inform policy. The frameworks we have developed go some way to building robust decision making processes for plant disease control, but our work is only a start to applying approaches from systems engineering to epidemiology. There is still much scope to build more complex, more robust, and more rigorous approaches. With increasing disease threats, the effects of climate change, and a growing and increasingly global population, the significance and necessity of improving these methods is clear.
